(this.webpackJsonpgallery=this.webpackJsonpgallery||[]).push([[0],{26:function(e,t,n){e.exports=n(56)},36:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),l=n(7),o=n.n(l),i=n(5),u=n(10),s=n(3),f="reducers/logicState/INIT_TAGS",m="reducers/logicState/SET_ERROR",p="reducers/logicState/SHOW_MODAL_WINDOW",d="create",b="edit",v="EDIT_FORM_DIALOG",h="CREATE_FORM_DIALOG",g="INFO_DIALOG",E="DELETE_FILE_DIALOG",_="DELETE_COLLECTION_DIALOG",O="CLEAR_STORAGE_DIALOG",w={activeFile:{title:"",file:null,collection:"",description:"",tags:[]},showModalType:null,currentColl:"Uncollected",collections:[],images:[],tags:[],searchQuery:"",stats:{usage:0,quota:0,filesCount:0},error:""},y=function(e,t){var n=t.type,a=t.value;switch(n){case"reducers/logicState/SET_ACTIVE_FILE":return a;default:return e}},C=function(e,t){var n=t.type,a=t.value;switch(n){case"reducers/logicState/UPDATE_STATS":return Object(s.a)({},a);default:return e}},j=function(e,t){switch(t.type){case"reducers/logicState/SET_COLLECTION":return t.value;default:return e}},N=function(e,t){var n=t.type,a=t.value;switch(n){case"reducers/logicState/SET_SEARCH_QUERY":return a;default:return e}},k=function(e,t){var n=t.type,a=t.value;switch(n){case"reducers/logicState/INIT_IMAGES_COLLECTION":return a;default:return e}},x=function(e,t){var n=t.type,a=t.value;switch(n){case"reducers/logicState/INIT_COLLECTIONS":return a;default:return e}},S=function(e,t){var n=t.type,a=t.value;switch(n){case f:return a;default:return e}},T=function(e,t){switch(t.type){case m:return t.value;default:return e}},A=function(e,t){switch(t.type){case p:return t.value;default:return e}},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;return{activeFile:y(e.activeFile,t),showModalType:A(e.showModalType,t),currentColl:j(e.currentColl,t),collections:x(e.collections,t),tags:S(e.tags,t),images:k(e.images,t),searchQuery:N(e.searchQuery,t),stats:C(e.stats,t),error:T(e.error,t)}},I=n(22),F=Object(u.c)(D,Object(u.a)(I.a)),L=(n(35),n(36),n(4)),U=n(13),R=function(e){var t=e.group,n=e.file,a=e.title,r=e.onEdit,l=e.onDelete;return c.a.createElement("li",{className:"collection__thumb"},c.a.createElement("a",{href:"#",className:"collection__thumb-link"},c.a.createElement("div",{className:"collection__thumb-content"},c.a.createElement(U.LightgalleryItem,{group:t,src:n},c.a.createElement("img",{className:"collection__thumb-img",src:n,alt:a}),c.a.createElement("section",{className:"collection__thumb-more"},c.a.createElement("div",{className:"collection__thumb-title"},a),c.a.createElement("div",{className:"collection__thumb-controls"},c.a.createElement("button",{className:"button thumb__delete-btn",onClick:l}),c.a.createElement("button",{className:"button thumb__edit-btn",onClick:r})))))))},M=function(e){var t=e.currentColl,n=void 0===t?"":t,a=e.images,l=void 0===a?[]:a,o=e.query,i=void 0===o?"":o,u=e.updateFileData,s=e.showFileConfirmDialog,f=e.selectFile,m=e.downloadCollectionArchive,p=Object(r.useState)(!1),d=Object(L.a)(p,2),b=d[0],v=d[1],h=Object(r.useState)(null),g=Object(L.a)(h,2),E=g[0],_=g[1],O=function(e){return function(t){f(e),s(),t.stopPropagation()}},w=l.map((function(e,t){var n,a=e.file,r=e.title,o=l[t];return c.a.createElement(R,{key:t,group:"group",file:a,title:r,onEdit:(n=o,function(e){u(n),e.stopPropagation()}),onDelete:O(o)})})),y=i?"Related to: ".concat(i):n;return c.a.createElement(U.LightgalleryProvider,{lightgallerySettings:{thumbnail:!1,dynamic:!0,dynamicEl:l},onAfterOpen:function(){v(!0)},onCloseAfter:function(){v(!1)},onAfterSlide:function(e){var t=e.detail;l.length&&_(l[t.index])}},c.a.createElement("section",{className:"content"},c.a.createElement("article",{className:"collection"},c.a.createElement("header",{className:"collection__header"},c.a.createElement("h3",{className:"title collection-title"},y),c.a.createElement("span",{className:"collection__stats"},"(".concat(l.length," images)")),c.a.createElement("button",{className:"button collection-download__btn",onClick:function(){return m()}},c.a.createElement("span",{className:"collection-download__icon"},"s"))),c.a.createElement("ul",{className:"collection__list"},w),function(){if(b){var e=E.title,t=E.format,n=E.dimensions,a=E.type,r=E.size,l=E.tags,o=E.description,i=Object(L.a)(n,2),u=i[0],s=i[1];return c.a.createElement("section",{className:"collection-caption lg-sub-html"},c.a.createElement("h4",null,e),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label"},"Format:")," ",t),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label"},"File size:")," ",r.toFixed(2)," MB"),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label"},"Dimensions:")," ","".concat(u,"x").concat(s)),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label"},"Type:")," ",a),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label"},"Tags:")," ",l.join(",")),c.a.createElement("p",null,c.a.createElement("span",{className:"collection-caption__label",style:{display:"block"}},"Description:"),o))}}())))},G=n(1),H=n.n(G),W=n(2),z=n(23),P=n.n(z),Q=n(24),q=n.n(Q),B=function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.blob()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(W.a)(H.a.mark((function e(t,n){var a,r,c;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=P()(),n.forEach((function(e){return a.file(e.title,e.file)})),e.next=4,a.generateAsync({type:"blob"});case 4:return r=e.sent,c="".concat(t,".zip"),e.abrupt("return",q.a.saveAs(r,c));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),J=function(e){return e/1048576},Y=function(e){return{type:"reducers/logicState/INIT_COLLECTIONS",value:e}},K=function(e){return{type:f,value:e}},X=function(e){return{type:"reducers/logicState/INIT_IMAGES_COLLECTION",value:e}},Z=function(e){return{type:"reducers/logicState/SET_COLLECTION",value:e}},$=function(e){return{type:"reducers/logicState/SET_ACTIVE_FILE",value:e}},ee=function(e){return{type:m,value:e}},te=function(e){return{type:"reducers/logicState/SET_SEARCH_QUERY",value:e}},ne=function(e){return{type:p,value:e}},ae=function(){return{type:p,value:null}},re=n(18),ce=n(9),le=new(n(25).a)("GalleryDB");le.version(1).stores((a={},Object(ce.a)(a,"images","++id, title, collection, *tags"),Object(ce.a)(a,"collections","++id, &title"),Object(ce.a)(a,"tags","++id, &name"),a)),le.on("populate",(function(){le.collections.bulkAdd([{title:"Uncollected"},{title:"All"}])}));var oe=function(){var e=Object(W.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("collections").orderBy(":id").toArray());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=Object(W.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("tags").orderBy(":id").toArray());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("collections").add({title:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("tags").add({name:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=Object(W.a)(H.a.mark((function e(t){var n,a=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.abrupt("return",le.transaction("rw",le.collections,le.images,Object(W.a)(H.a.mark((function e(){var a;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.table("images").where({collection:t});case 2:if(a=e.sent,!n){e.next=8;break}return e.next=6,a.delete();case 6:e.next=10;break;case 8:return e.next=10,a.modify((function(e){return e.collection="Uncollected"}));case 10:return e.next=12,le.table("collections").where({title:t}).delete();case 12:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("images").delete(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(W.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.transaction("rw",le.collections,le.images,Object(W.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.table("collections").where({title:n}).modify({title:t});case 2:return e.next=4,le.table("images").where({collection:n}).modify((function(e){return e.collection=t}));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Uncollected";return"All"===e?le.table("images").toArray():le.table("images").where({collection:e}).toArray()},ve="Landscape",he="Portrait",ge="Square",Ee=function(e){var t=Object(L.a)(e,2),n=t[0],a=t[1];return n>a?ve:n<a?he:n===a?ge:void 0},_e=function(e){return new Promise((function(t){var n=new Image(e);n.src=e,n.addEventListener("load",(function(){t([this.naturalWidth||this.width,this.naturalHeight||this.height])}))}))},Oe=function(){var e=Object(W.a)(H.a.mark((function e(){var t,n,a,r,c,l,o,i,u,s,f,m,p,d,b,v,h,g=arguments;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:{},n=t.title,a=void 0===n?"":n,r=t.fileURL,c=void 0===r?null:r,l=t.collection,o=void 0===l?"Uncollected":l,i=t.type,u=void 0===i?"":i,s=t.size,f=void 0===s?0:s,m=t.tags,p=void 0===m?[]:m,d=t.description,b=void 0===d?"":d,e.next=4,_e(c);case 4:return v=e.sent,e.next=7,B(c);case 7:return h=e.sent,URL.revokeObjectURL(c),e.abrupt("return",le.transaction("rw",le.images,Object(W.a)(H.a.mark((function e(){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={title:a,file:h,format:Ee(v),dimensions:v,type:u,size:J(f),collection:o,tags:p,description:b},t.id&&(n.id=t.id),le.table("images").put(n);case 3:case"end":return e.stop()}}),e)})))));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),we=function(){var e=Object(W.a)(H.a.mark((function e(){var t,n,a,r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.table("images").count();case 2:if(t=e.sent,n="U/A",a="U/A",!navigator.storage||!navigator.storage.estimate){e.next=13;break}return e.next=8,navigator.storage.estimate();case 8:r=e.sent,n=r.quota,a=r.usage,e.next=14;break;case 13:console.error("StorageManager not found");case 14:return e.abrupt("return",{filesCount:t,quota:n,usage:a});case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye={getImagesCollection:be,getCollections:oe,getTags:ie,addCollection:ue,addTag:se,removeCollection:fe,uploadImage:Oe,clearStorage:function(){var e=Object(W.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",le.table("images").clear());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),renameCollection:pe,getStats:we,downloadImagesCollection:de,search:function(){var e=Object(W.a)(H.a.mark((function e(t,n){var a,r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.table("images").where("tags").anyOf(n).toArray();case 2:return a=e.sent,e.next=5,le.table("images").where("title").startsWithAnyOfIgnoreCase(t).toArray();case 5:return r=e.sent,e.abrupt("return",[].concat(Object(re.a)(a),Object(re.a)(r)));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),removeFile:me},Ce=function(e){return function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye.uploadImage(Object(s.a)(Object(s.a)({},e),{},{fileURL:URL.createObjectURL(e.file)}));case 2:n(Ne(e.collection)),n(ae());case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},je=function(){return function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ye.getStats().then((function(e){return t({type:"reducers/logicState/UPDATE_STATS",value:e})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Uncollected";return function(){var t=Object(W.a)(H.a.mark((function t(n){var a,r;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye.getImagesCollection(e);case 2:a=t.sent,r=a.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{file:URL.createObjectURL(e.file)})})),n(X(r)),n(Z(e)),n(te("")),n(je());case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ke=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(){var n=Object(W.a)(H.a.mark((function n(a){return H.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,ye.removeCollection(e,t);case 2:a(xe());case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},xe=function(e){return function(){var t=Object(W.a)(H.a.mark((function t(n){var a;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ye.getCollections();case 2:a=t.sent,n(Y(a)),n(Ne(e));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Se=function(){return function(){var e=Object(W.a)(H.a.mark((function e(t){var n;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.getTags();case 2:n=e.sent,t(K(n.map((function(e){return e.name}))));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Te=Object(i.b)((function(e){return{currentColl:e.currentColl,images:e.images,query:e.searchQuery}}),{updateFileData:function(e){return function(t){t(ne(v)),t($(Object(s.a)(Object(s.a)({},e),{},{file:null})))}},showFileConfirmDialog:function(){return{type:p,value:E}},selectFile:$,downloadCollectionArchive:function(){return function(){var e=Object(W.a)(H.a.mark((function e(t,n){var a;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.downloadImagesCollection();case 2:a=e.sent,V(n().currentColl,a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}})(M),Ae=n(8),De=n.n(Ae),Ie=function(e){var t=e.collections,n=void 0===t?[]:t,a=e.currentColl,l=e.getCollections,o=e.switchCollection,i=e.editCollectionName,u=e.addNewCollection,f=(e.removeCollection,e.showCollectionConfirmDialog),m=e.search;Object(r.useEffect)((function(){l()}),[]),Object(r.useEffect)((function(){N(a)}),[a]);var p=Object(r.useState)({mode:d,initialValue:""}),v=Object(L.a)(p,2),h=v[0],g=v[1],E=Object(r.useState)(""),_=Object(L.a)(E,2),O=_[0],w=_[1],y=Object(r.useState)(""),C=Object(L.a)(y,2),j=C[0],N=C[1],k=Object(r.useState)(!1),x=Object(L.a)(k,2),S=x[0],T=x[1],A=function(e){return function(t){t.preventDefault(),o(e)}},D=n.map((function(e){var t,n=e.title,r=De()("collections-names-link","filter__list-link",{active:a===n}),l=n.length>18?"".concat(n.slice(0,18),"..."):n;return c.a.createElement("li",{className:"collections-names__item",key:n,title:n},c.a.createElement("a",{href:"#",className:r,onClick:A(n)},l),c.a.createElement("button",{onClick:(t=n,function(e){g({initialValue:t,mode:b}),N(t),T(!0)}),className:"button collections__edit-btn",type:"button"}))}));return c.a.createElement("section",{className:"filter"},c.a.createElement("article",{className:"search"},c.a.createElement("form",{className:"search-form",onSubmit:function(e){return e.preventDefault()}},c.a.createElement("input",{type:"text",className:"input search-form__input",value:O,placeholder:"Search by #tags, 'title'",onChange:function(e){var t=e.target;return w(t.value)},onKeyDown:function(e){"Enter"===e.key&&m(O)}}))),c.a.createElement("article",{className:"collections filter__item"},c.a.createElement("section",{className:"collections__header"},c.a.createElement("h3",{className:"title panel-title"},"Collections"),c.a.createElement("button",{title:"Add collection",className:"button collections__add-btn",onClick:function(){g((function(e){return Object(s.a)(Object(s.a)({},e),{},{mode:d})})),N(""),T(!S)}})),c.a.createElement("ul",{className:"collections-names filter__list"},c.a.createElement("li",{key:"collection-create",className:De()("collections-names__create",{"collections-names__create_visible":S})},c.a.createElement("input",{onChange:function(e){var t=e.target;N(t.value)},value:j,className:"collections-input collections-names__input filter__list-link active"}),c.a.createElement("div",{className:"collections-names__controls"},c.a.createElement("button",{title:"Accept",className:"button collections__accept-btn",onClick:function(){j&&(h.mode===b?i(h.initialValue,j):u(j),T(!S))},type:"button"}),c.a.createElement("button",{title:"Cancel",className:"button collections__cancel-btn",onClick:function(){T(!S)},type:"button"}),h.mode===b&&c.a.createElement("button",{title:"Remove",className:"button collections__remove-btn",onClick:function(){T(!S),f()},type:"button"}))),D)))},Fe=Object(i.b)((function(e){return{collections:e.collections,currentColl:e.currentColl}}),{removeCollection:ke,getCollections:xe,switchCollection:Ne,editCollectionName:function(e,t){return function(n){return ye.renameCollection(t,e).then((function(){return n(xe(t))}))}},addNewCollection:function(e){return function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.addCollection(e);case 3:n(xe(e)),t.next=11;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0),n(ee("Collection with this name already exist")),n(n(ne(g)));case 11:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},showCollectionConfirmDialog:function(){return{type:p,value:_}},search:function(e){return function(){var t=Object(W.a)(H.a.mark((function t(n){var a,r,c,l,o,i;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return a=e.split(" "),r=a.filter((function(e){return!e.startsWith("#")})),c=a.filter((function(e){return e.startsWith("#")})),t.next=7,ye.search(r,c);case 7:l=t.sent,o=l.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{file:URL.createObjectURL(e.file)})})),i=(c.length?"tags - [".concat(c,"] "):"")+(r.length?"titles - [".concat(r,"]"):""),n(te(i)),n(X(o));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})(Ie),Le=function(e){var t=e.stats,n=e.showStorageConfirmDialog,a=Object(r.useState)(t),l=Object(L.a)(a,2),o=l[0],i=l[1];Object(r.useEffect)((function(){return i(t)}),[t]);var u=J(o.usage).toFixed(2),s=Math.round(J(o.quota)),f=(u/s*100).toFixed(2);return c.a.createElement("section",{className:"panel-stats"},c.a.createElement("a",{className:"panel-stats__clear-link",href:"#",onClick:function(e){e.preventDefault(),n()}},c.a.createElement("span",{className:"panel-stats__size"},"".concat(u,"/").concat(s,"MB (").concat(f,"%)")),c.a.createElement("span",{className:"panel-stats__files"},o.filesCount," files")))},Ue=Object(i.b)((function(e){return{stats:e.stats}}),{showStorageConfirmDialog:function(){return{type:p,value:O}}})(Le),Re=function(e){var t=e.showCreateFormDialog,n=De()("button","upload-btn");return c.a.createElement("aside",{className:"panel"},c.a.createElement("div",{className:"panel__inner"},c.a.createElement("button",{className:n,onClick:function(e){t()}},"Upload"),c.a.createElement(Ue,null),c.a.createElement(Fe,null)))},Me=Object(i.b)(null,{uploadFile:Ce,showCreateFormDialog:function(){return{type:p,value:h}}})(Re),Ge=function(e){var t=Object(r.useState)(!1),n=Object(L.a)(t,2),a=n[0],l=n[1],o=De()("button","app__menu-btn","menu-btn",{"menu-btn_active":a});return c.a.createElement("button",{className:o,onClick:function(){return l((function(e){return!e}))},type:"button"},c.a.createElement("div",{className:"menu-btn__row1"}),c.a.createElement("div",{className:"menu-btn__row2"}),c.a.createElement("div",{className:"menu-btn__row3"}))},He=function(e){var t=e.isVisible,n=e.onClose,a=e.container,l=void 0===a?document.body:a,i=e.children,u=Object(r.useState)(document.createElement("div")),s=Object(L.a)(u,1)[0];Object(r.useEffect)((function(){return l.appendChild(s),function(){return l.removeChild(s)}}),[]);var f=c.a.createElement("div",{className:"modal-window"},c.a.createElement("div",{className:"modal-window__content"},c.a.createElement("button",{className:"button close-btn modal-window__close-btn",onClick:n,type:"button"}),i));return t&&o.a.createPortal(f,s)},We="image/*",ze=function(e){var t=e.mode,n=e.activeFile,a=e.collections,l=e.tags,o=void 0===l?[]:l,i=e.activeCollection,u=e.uploadFile,f=e.closeHandler,m=e.addNewTag,p=e.getTags,b=Object(r.useState)(t===d?{title:"",file:null,collection:"",description:"",tags:[]}:n),v=Object(L.a)(b,2),h=v[0],g=v[1],E=Object(r.useState)(""),_=Object(L.a)(E,2),O=_[0],w=_[1],y=Object(r.useState)(!1),C=Object(L.a)(y,2),j=C[0],N=C[1];Object(r.useEffect)((function(){p()}),[]),Object(r.useEffect)((function(){g((function(e){return Object(s.a)(Object(s.a)({},e),{},{collection:i})}))}),[i]);var k=a.filter((function(e){return"All"!==e.title})).map((function(e){var t=e.title;return c.a.createElement("option",{key:t,value:t},t)})),x=o.map((function(e){return c.a.createElement("option",{key:e,value:e},e)}));return c.a.createElement("div",{className:"upload-form"},c.a.createElement("div",{className:"upload-form__row upload-form__file"},c.a.createElement("label",{className:"upload-form__label",htmlFor:"upload-btn",tabIndex:"0"},"Upload a file:"),c.a.createElement("input",{id:"upload-btn",onChange:function(e){var t=e.target,n=Object.values(t.files),a=Object(L.a)(n,1)[0];g((function(e){return Object(s.a)(Object(s.a)({},e),{},{title:a.name,file:a,type:a.type,size:a.size})})),N(!1)},type:"file",accept:We}),j?c.a.createElement("span",{className:"upload-form__file-error"},"Please select file to upload"):null),c.a.createElement("div",{className:"upload-form__row upload-form__name"},c.a.createElement("label",{className:"upload-form__label",htmlFor:"file-name"},"File name:"),c.a.createElement("input",{id:"file-name",value:h.title,type:"text",onChange:function(e){var t=e.target;return g((function(e){return Object(s.a)(Object(s.a)({},e),{},{title:t.value})}))}})),c.a.createElement("div",{className:"upload-form__row upload-form__collection"},c.a.createElement("label",{htmlFor:"file-collection"},"Collection:"),c.a.createElement("select",{id:"file-collection",value:i,onChange:function(e){var t=e.target;return g((function(e){return Object(s.a)(Object(s.a)({},e),{},{collection:t.value})}))}},k)),c.a.createElement("div",{className:"upload-form__row upload-form__tags"},c.a.createElement("label",{htmlFor:"file-tags"},"Tags:"),c.a.createElement("div",{className:"upload-form__new-tag"},c.a.createElement("input",{value:O,type:"text",onChange:function(e){var t=e.target.value.trim();t.startsWith("#")?w(t):w("#".concat(t))}}),c.a.createElement("button",{className:"button upload__add-btn",onClick:function(){""!==O&&"#"!==O&&m(O)}},"Add")),c.a.createElement("select",{className:"upload-form__tag-list",id:"file-tags",size:3,onChange:function(e){var t=e.target,n=Array.from(t.options).filter((function(e){return e.selected})).map((function(e){return e.value}));g((function(e){return Object(s.a)(Object(s.a)({},e),{},{tags:n})}))},multiple:!0},x)),c.a.createElement("div",{className:"upload-form__description"},c.a.createElement("label",{htmlFor:"file-description"},"Description:"),c.a.createElement("textarea",{id:"file-description",rows:2,onChange:function(e){var t=e.target;return g((function(e){return Object(s.a)(Object(s.a)({},e),{},{description:t.value})}))},value:h.description})),c.a.createElement("div",{className:"upload-form__row upload-form__controls"},c.a.createElement("button",{className:"button cancel-btn",onClick:f,type:"button"},"Cancel"),c.a.createElement("button",{className:"button ok-btn",onClick:function(){var e=h.title,t=h.file;e&&t?(u(h),f(),N(!1)):N(!0)},type:"button"},"Upload")))},Pe=Object(i.b)((function(e){return{activeFile:e.activeFile,activeCollection:e.currentColl,collections:e.collections,tags:e.tags}}),{uploadFile:Ce,addNewTag:function(e){return function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.addTag(e);case 3:n(Se()),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},getTags:Se})(ze),Qe=function(e){var t=e.message,n=e.onClose,a=e.setError;return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",{style:{marginBottom:"25px"}},t),c.a.createElement("button",{className:"button ok-btn",onClick:function(){n(),a("")},type:"button"},"Ok"))},qe=Object(i.b)((function(e){return{message:e.error}}),{setError:ee})(Qe),Be=function(e){var t=e.cancelHandler,n=e.onDelete,a=e.onFullDelete,r=e.children,l=e.extraQuestion,o=void 0!==l&&l;return c.a.createElement("section",{className:"confirm-dialog"},r,c.a.createElement("div",{className:"confirm-dialog__controls"},c.a.createElement("button",{className:"button confirm-dialog__btn cancel-btn",onClick:t,type:"button"},"Cancel"),c.a.createElement("button",{className:"button confirm-dialog__btn ok-btn",onClick:n,type:"button"},"Delete"),o?c.a.createElement("button",{className:"button confirm-dialog__btn ok-btn",onClick:a,type:"button"},"Delete with files"):null))};var Ve=function(e){var t=e.showModalType,n=e.hideModalWindow,a=e.removeCollection,l=e.switchCollection,o=e.removeActiveFile,i=e.currentColl,u=e.clearStorage,s=Object(r.useState)(!1),f=Object(L.a)(s,2),m=f[0],p=f[1],w=function(){p(!m),n()};Object(r.useEffect)((function(){t&&p(!0)}),[t]);var y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){a(i,e),w()}},C=t===v?c.a.createElement(Pe,{mode:b,closeHandler:w}):t==h?c.a.createElement(Pe,{mode:d,closeHandler:w}):void 0,j=t===g&&c.a.createElement(qe,{onClose:w}),N=t===E&&c.a.createElement(Be,{cancelHandler:w,onDelete:function(){o(),l(i),w()}},c.a.createElement("p",null,"Do you really want to delete ",c.a.createElement("strong",null,"current file"),"?")),k=t===O&&c.a.createElement(Be,{cancelHandler:w,onDelete:function(){u(),w()}},c.a.createElement("p",null,"Do you really want to delete ",c.a.createElement("strong",null,"all files"),"?")),x=t===_&&c.a.createElement(Be,{cancelHandler:w,onDelete:y(),onFullDelete:y(!0),extraQuestion:!0},c.a.createElement("p",null,"Do you really want to delete collection?"));return c.a.createElement("main",{className:"app"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"app__inner"},c.a.createElement(Ge,null),c.a.createElement(Me,null),c.a.createElement(Te,null),c.a.createElement(He,{isVisible:m,onClose:w},C,j,N,x,k))))},Je=Object(i.b)((function(e){return{currentColl:e.currentColl,showModalType:e.showModalType}}),{hideModalWindow:ae,removeCollection:ke,switchCollection:Ne,removeActiveFile:function(){return function(){var e=Object(W.a)(H.a.mark((function e(t,n){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ye.removeFile(n().activeFile.id));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},clearStorage:function(){return function(){var e=Object(W.a)(H.a.mark((function e(t){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ye.clearStorage().then((function(){return t(Ne())})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(Ve);o.a.render(c.a.createElement(i.a,{store:F},c.a.createElement(Je,null)),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.4c3992b6.chunk.js.map